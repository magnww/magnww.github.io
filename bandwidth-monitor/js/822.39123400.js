"use strict";(globalThis["webpackChunkbandwidth_monitor"]=globalThis["webpackChunkbandwidth_monitor"]||[]).push([[822],{6677:(e,t,l)=>{l.d(t,{Z:()=>V});var i=l(9835),a=l(6970);const o={class:"text-h6"};function n(e,t,l,n,r,s){const d=(0,i.up)("q-space"),u=(0,i.up)("q-btn"),c=(0,i.up)("q-card-section"),f=(0,i.up)("q-input"),m=(0,i.up)("q-form"),p=(0,i.up)("q-card-actions"),h=(0,i.up)("q-card"),g=(0,i.up)("q-dialog"),b=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(g,{modelValue:r.dialogVisible,"onUpdate:modelValue":t[6]||(t[6]=e=>r.dialogVisible=e)},{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,{class:"row items-center q-pb-none"},{default:(0,i.w5)((()=>[(0,i._)("div",o,(0,a.zw)(r.title),1),(0,i.Wm)(d),(0,i.wy)((0,i.Wm)(u,{icon:"mdi-close",flat:"",round:"",dense:""},null,512),[[b]])])),_:1}),(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[(0,i.Wm)(m,{ref:"form",onSubmit:s.onSubmit},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{filled:"",modelValue:r.config.name,"onUpdate:modelValue":t[0]||(t[0]=e=>r.config.name=e),label:"Name","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type Name"]},null,8,["modelValue","rules"]),(0,i.Wm)(f,{filled:"",modelValue:r.config.ip,"onUpdate:modelValue":t[1]||(t[1]=e=>r.config.ip=e),label:"IP","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type IP"]},null,8,["modelValue","rules"]),(0,i.Wm)(f,{filled:"",modelValue:r.config.port,"onUpdate:modelValue":t[2]||(t[2]=e=>r.config.port=e),modelModifiers:{number:!0},type:"number",label:"Port","lazy-rules":"",rules:[e=>e&&e>0&&e<=65535||"Please type Port"]},null,8,["modelValue","rules"]),(0,i.Wm)(f,{filled:"",modelValue:r.config.startDay,"onUpdate:modelValue":t[3]||(t[3]=e=>r.config.startDay=e),modelModifiers:{number:!0},type:"number",label:"Billing Cycle Start Day","lazy-rules":"",rules:[e=>e&&e>=1&&e<=31||"Please type Billing Cycle Start Day"]},null,8,["modelValue","rules"]),(0,i.Wm)(f,{filled:"",modelValue:r.config.bandwidth,"onUpdate:modelValue":t[4]||(t[4]=e=>r.config.bandwidth=e),label:"Bandwidth","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type Bandwidth"]},null,8,["modelValue","rules"])])),_:1},8,["onSubmit"])])),_:1}),(0,i.Wm)(p,{align:"right"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{flat:"",label:"OK",color:"primary",onClick:t[5]||(t[5]=t=>e.$refs.form.submit())}),l.id?((0,i.wg)(),(0,i.j4)(u,{key:0,flat:"",label:"Delete",color:"negative",onClick:s.onClickDelete},null,8,["onClick"])):(0,i.kq)("",!0),(0,i.wy)((0,i.Wm)(u,{flat:"",label:"Cancel",outline:""},null,512),[[b]])])),_:1})])),_:1})])),_:1},8,["modelValue"])}l(8964),l(8170),l(5231),l(7725),l(9212),l(548),l(9359),l(6408),l(9665);function r(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}const s={props:{visible:Boolean,id:String},emits:["update:visible","save"],data(){return{dialogVisible:this.visible,title:this.id?"Edit Server":"Add Server",config:{}}},watch:{visible(e){this.dialogVisible=e,e&&this.load()},id(e){e&&this.load()},dialogVisible(e){this.$emit("update:visible",e)}},methods:{load(){if(this.id){const e=this.$q.localStorage.getItem("servers")||[];this.config=e.find((e=>e.id===this.id)),this.title="Edit Server"}else this.title="Add Server"},onSubmit(){const e=this.$q.localStorage.getItem("servers")||[],t=Object.assign({id:r()},this.config);if(this.id){const l=e.find((e=>e.id===this.id));l&&e.splice(e.indexOf(l),1,t)}else e.push(t);this.$q.localStorage.set("servers",e),this.dialogVisible=!1,this.$emit("save")},onClickDelete(){this.$q.dialog({title:"Confirm",message:"Would you like to delete?",cancel:!0,persistent:!0}).onOk((()=>{const e=this.$q.localStorage.getItem("servers")||[],t=e.find((e=>e.id===this.id));t&&(e.splice(e.indexOf(t),1),this.$q.localStorage.set("servers",e),this.dialogVisible=!1,this.$emit("save"))}))}}};var d=l(1639),u=l(5263),c=l(4458),f=l(3190),m=l(136),p=l(4455),h=l(8326),g=l(1169),b=l(1821),w=l(2146),y=l(9984),v=l.n(y);const B=(0,d.Z)(s,[["render",n]]),V=B;v()(s,"components",{QDialog:u.Z,QCard:c.Z,QCardSection:f.Z,QSpace:m.Z,QBtn:p.Z,QForm:h.Z,QInput:g.Z,QCardActions:b.Z}),v()(s,"directives",{ClosePopup:w.Z})},5822:(e,t,l)=>{l.r(t),l.d(t,{default:()=>_});var i=l(9835),a=l(6970);const o={class:"row no-wrap justify-between"},n={class:"text-h6"},r={class:"text-subtitle2"},s={class:"absolute-full flex flex-center"};function d(e,t,l,d,u,c){const f=(0,i.up)("q-btn"),m=(0,i.up)("q-card-actions"),p=(0,i.up)("q-card-section"),h=(0,i.up)("q-badge"),g=(0,i.up)("q-linear-progress"),b=(0,i.up)("q-card"),w=(0,i.up)("q-pull-to-refresh"),y=(0,i.up)("add-or-modify-entry"),v=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(v,{class:"column no-wrap"},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{onRefresh:c.refresh},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(u.servers,((e,t)=>((0,i.wg)(),(0,i.j4)(b,{key:t},{default:(0,i.w5)((()=>[(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i._)("div",o,[(0,i._)("div",null,[(0,i._)("div",n,(0,a.zw)(e.name),1),(0,i._)("div",r,(0,a.zw)(e.ip)+":"+(0,a.zw)(e.port),1)]),(0,i.Wm)(m,{vertical:"",class:"justify-around q-px-md"},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{flat:"",round:"",icon:"mdi-cog",onClick:t=>c.onClickModify(e)},null,8,["onClick"])])),_:2},1024)])])),_:2},1024),(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i.Wm)(g,{size:"25px",value:(e.traffic.rx+e.traffic.tx)/e.totalTraffic,color:"primary"},{default:(0,i.w5)((()=>[(0,i._)("div",s,[(0,i.Wm)(h,{color:"white","text-color":"primary",label:c.formatBytes(e.traffic.rx+e.traffic.tx)+" / "+c.formatBytes(e.totalTraffic)},null,8,["label"])])])),_:2},1032,["value"])])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["onRefresh"]),(0,i.Wm)(y,{visible:u.addEntryVisible,"onUpdate:visible":t[0]||(t[0]=e=>u.addEntryVisible=e),id:u.selectedId,onSave:c.load},null,8,["visible","id","onSave"])])),_:1})}l(8964),l(9665);var u=l(6677),c=l(112),f=l(5783),m=l.n(f);function p(e,t=2){if(!+e)return"0 Bytes";const l=1024,i=t<0?0:t,a=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],o=Math.floor(Math.log(e)/Math.log(l));return`${parseFloat((e/Math.pow(l,o)).toFixed(i))} ${a[o]}`}function h(e){const t=1024,l=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=["Bytes","K","M","G","T","P","E","Z","Y"];if(!isNaN(e))return Number(e);for(let a=0;a<l.length;a++){let o=e.replace(new RegExp(l[a],"i"),"");if(!isNaN(o))return Number(o)*Math.pow(t,a);if(o=e.replace(new RegExp(i[a],"i"),""),!isNaN(o))return Number(o*Math.pow(t,a))}}const g={components:{AddOrModifyEntry:u.Z},data(){return{servers:[],addEntryVisible:!1,selectedId:null}},mounted(){this.load()},methods:{formatBytes:p,load(){const e=(new Date).getFullYear(),t=(new Date).getMonth()+1,l=(new Date).getDate(),i=this.$q.localStorage.getItem("servers")||[],a=[],o=i.map((({id:i,name:o,ip:n,port:r,startDay:s,bandwidth:d})=>{const u=new Date(e,t-1+(l<s?-1:0),s),f=new Date(e,t+(l<s?-1:0),s-1),p={id:i,name:o,ip:n,port:r,traffic:{},totalTraffic:null};return a.push(p),c.Z.get(`http://${n}:${r}/api?days=1&begin=${m()(u).format("YYYY-MM-DD")}&end=${m()(f).format("YYYY-MM-DD")}&json=1`).then((e=>{const t=e.data.interfaces[0].traffic;p.traffic=t.day.reduce(((e,t)=>({rx:e.rx+t.rx,tx:e.tx+t.tx}))),p.totalTraffic=h(d)})).catch((e=>{console.log(e)})).finally((function(){}))}));return Promise.all(o).then((()=>{this.servers=a}))},refresh(e){this.load().then((()=>{e()}))},onClickModify(e){this.selectedId=e.id,this.addEntryVisible=!0}}};var b=l(1639),w=l(9885),y=l(699),v=l(4458),B=l(3190),V=l(1821),q=l(4455),Z=l(8289),x=l(990),S=l(9984),W=l.n(S);const C=(0,b.Z)(g,[["render",d]]),_=C;W()(g,"components",{QPage:w.Z,QPullToRefresh:y.Z,QCard:v.Z,QCardSection:B.Z,QCardActions:V.Z,QBtn:q.Z,QLinearProgress:Z.Z,QBadge:x.Z})}}]);